services:
  # ASP.NET Core Web Application
  - type: web
    name: mocvistore
    runtime: dotnet
    region: singapore
    plan: free
    buildCommand: dotnet publish -c Release -o out && cd Trainning_AI && pip3 install -r requirements.txt
    startCommand: cd Trainning_AI && python3 -m uvicorn app.main:app --host 0.0.0.0 --port 8000 & sleep 3 && cd .. && dotnet out/Exe_Demo.dll
    envVars:
      # ASP.NET Core Settings
      - key: ASPNETCORE_ENVIRONMENT
        value: Production
      
      - key: ASPNETCORE_URLS
        value: http://0.0.0.0:$PORT
      
      - key: ASPNETCORE_FORWARDEDHEADERS_ENABLED
        value: true
      
      # AI Service URL (localhost vì chạy cùng service)
      - key: AI__ApiUrl
        value: http://localhost:8000
      
      # Google OAuth (Cần thêm thủ công trên Render Dashboard)
      - key: Authentication__Google__ClientId
        sync: false
      
      - key: Authentication__Google__ClientSecret
        sync: false
      
      # Email Settings (Cần thêm thủ công)
      - key: EmailSettings__SmtpServer
        value: smtp.gmail.com
      
      - key: EmailSettings__SmtpPort
        value: 587
      
      - key: EmailSettings__SenderEmail
        sync: false
      
      - key: EmailSettings__SenderPassword
        sync: false
      
      - key: EmailSettings__SenderName
        value: Mộc Vị Store
      
      # Gemini API Key cho AI (Cần thêm thủ công)
      - key: GEMINI_API_KEY
        sync: false
